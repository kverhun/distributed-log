### ReplicatedLog app
[ReplicatedLog](src/ReplicatedLogApp/ReplicatedLog.cpp) app can be run in "master" and in "secondary" modes depending on command line parameters.

When run in master mode, "semi-synchronous" replication to secondaries is performed (based on write concern level).

When run in secondary mode, random delay (between 5 and 10 seconds) is performed when receiving message.

Master/Secondary communication is performed using HTTP requests.

When master performs replication to secondary, the generated message ID is passed to maintain message order. 

Acknowledgement is generated by taking hash of message string and is send as HTTP request reply.

Requests are handled asynchronously (except of POST which is sync until target write concern is reached),
so it is possible to POST new messages and GET messages while previous replication is not yet fully performed.

In case of unsuccessful replication, the retry is performed.
Order of messages is maintained using sequentially generated IDs by master.

Main logic is located in [src/ReplicatedLogApp/ReplicatedLog.cpp](src/ReplicatedLogApp/ReplicatedLog.cpp) in `main()` function.

1. Server is setup
2. POST and GET handlers are set to handle corresponding requests

Replication is run on POST request:
1. Message is parsed (write concern or ID is read)
2. For secondary node - random delay
3. Message is appended to in-memory message storage
4. Messages are sorted by ID to maintain order
5. For master node:
    - replication is triggered for each registered secondary
    - waiting until write concern is fulfilled
    - when write concern is fulfilled, other pending replications are moved to "backlog" to finish in background
    - all finished replications are cleaned up
6. Acknowledgement is returned
    
### Usage example:

```sh
# Run "master" listening to 8000 port and register ports 8005 and 8006 for secondaries
./ReplicatedLog 8000 8005 8006 &

# Run "secondary" listening to 8005 port
./ReplicatedLog 8005 &

# Run "secondary" listening to 8006 port
./ReplicatedLog 8005 &

# Get request: response - list of messages
curl -X GET "http://localhost:8000" # -> []
curl -X GET "http://localhost:8005" # -> []
curl -X GET "http://localhost:8006" # -> []

# Write concern is specified in [] before message in the POST request data 

# Post message to master with write concern 1
curl -d "[1]message1" -X POST "http://localhost:8000"

# Post message to master with write concern 3
curl -d "[3]message2" -X POST "http://localhost:8006"

# Get messages
curl -X GET "http://localhost:8000" # -> [message1, message2]
curl -X GET "http://localhost:8005" # -> [message1, message2]
curl -X GET "http://localhost:8006" # -> [message1, message2]
```

Video with work example:

[GDrive video link](https://drive.google.com/file/d/1bBdm6pAZAfLWQ_Mm734Nul_497PyMB0d/view?usp=share_link)
